---
phase: 21-ui-design-system-enforcement
plan: 02
type: execute
---

<objective>
Create unified Button and Card components with smooth animations to replace inconsistent inline patterns across the platform.

Purpose: Establish consistent UI primitives that enforce design system tokens while providing delightful micro-interactions. Eliminate the 15+ button variations and multiple card patterns currently scattered throughout the codebase.
Output: Production-ready Button and Card components with full test coverage, ready for platform-wide migration.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-ui-design-system-enforcement/CONTEXT.md
@.planning/phases/21-ui-design-system-enforcement/21-01-SUMMARY.md
@.planning/codebase/CONVENTIONS.md
@.planning/codebase/CONCERNS.md
@src/lib/animations/variants.ts
@src/lib/animations/transitions.ts
@src/components/ui/PageTransition.tsx

**Tech stack available:** Framer Motion (21-01), Vitest + Testing Library (Phase 20), Tailwind design tokens
**Animation variants available:** fadeIn, slideIn, scaleUp, stagger from variants.ts
**Transition configs available:** spring, easeOut, smooth from transitions.ts

**From CONTEXT.md - Button requirements:**
- Variants: primary, secondary, ghost, danger
- Sizes: sm (32px), md (44px - mobile touch target), lg (56px)
- States: disabled, loading
- Icon support: icon prop and iconOnly prop
- Animations: whileHover (scale 1.02 + shadow), whileTap (scale 0.98)

**From CONTEXT.md - Card requirements:**
- Compound components: Card.Header, Card.Title, Card.Description, Card.Content, Card.Footer
- Variants: default (shadow), interactive (hover effect), flat (no shadow)
- Consistent tokens: shadow-card, rounded-design-lg, padding via card/card-md/card-lg
- Hover animation: elevation change (shadow lift)

**From CONCERNS.md:**
- Issue: No unified button component - 15+ different inline button styles
- Issue: Multiple card patterns with different shadows/borders/radii
- Impact: Inconsistent UI, maintenance nightmare
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Button component with variants and Framer Motion animations</name>
  <files>src/components/ui/Button.tsx</files>
  <action>
    Create src/components/ui/Button.tsx as a 'use client' component:

    **Props interface:**
    - variant: 'primary' | 'secondary' | 'ghost' | 'danger'
    - size: 'sm' | 'md' | 'lg'
    - disabled: boolean (optional)
    - loading: boolean (optional)
    - icon: ReactNode (optional) - icon to display before text
    - iconOnly: boolean (optional) - for icon-only buttons (requires aria-label)
    - children: ReactNode
    - className: string (optional) - additional classes via cn()
    - All standard button HTML attributes via ...props

    **Styling with Tailwind tokens:**
    - Primary: bg-primary-500 hover:bg-primary-600 text-white
    - Secondary: bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600
    - Ghost: transparent hover:bg-gray-100 dark:hover:bg-gray-800
    - Danger: bg-red-500 hover:bg-red-600 text-white
    - Size sm: px-3 py-1.5 text-sm min-h-[32px]
    - Size md: px-4 py-2 text-base min-h-[44px] (default, mobile touch target)
    - Size lg: px-6 py-3 text-lg min-h-[56px]
    - Disabled: opacity-50 cursor-not-allowed
    - Loading: show spinner, disable interaction

    **Framer Motion animations:**
    - Use motion.button from framer-motion
    - whileHover: { scale: 1.02, boxShadow: "0 8px 16px rgba(0,0,0,0.1)" } (unless disabled/loading)
    - whileTap: { scale: 0.98 } (unless disabled/loading)
    - transition: spring from transitions.ts
    - Respect prefers-reduced-motion (disable animations if shouldReduceMotion)

    **Loading state:** Show spinner icon (lucide-react Loader2 with animate-spin), hide children text

    Use cn() from @/lib/utils for class merging. Export as default.
  </action>
  <verify>Button.tsx exists, compiles without errors, can import from @/components/ui/Button</verify>
  <done>Button component created with all variants (primary, secondary, ghost, danger), sizes (sm, md, lg), animations (hover scale + shadow, tap scale), loading state, icon support, respects prefers-reduced-motion</done>
</task>

<task type="auto">
  <name>Task 2: Create Card component with compound components and hover animations</name>
  <files>src/components/ui/Card.tsx</files>
  <action>
    Create src/components/ui/Card.tsx with compound component pattern:

    **Main Card component ('use client'):**
    - Props: variant ('default' | 'interactive' | 'flat'), className, onClick (optional), children
    - Use motion.div for animations
    - Default variant: bg-white dark:bg-gray-800 shadow-card rounded-design-lg
    - Interactive variant: cursor-pointer + hover animation
    - Flat variant: bg-white dark:bg-gray-800 rounded-design-lg (no shadow)
    - Base padding: p-card (applies to default layout)

    **Interactive hover animation:**
    - whileHover: { y: -4, boxShadow: "0 12px 24px rgba(0,0,0,0.15)" }
    - transition: smooth from transitions.ts
    - Only apply to interactive variant
    - Respect prefers-reduced-motion

    **Compound components (all Server Components - no 'use client' needed):**
    - Card.Header: flex justify-between items-start mb-4
    - Card.Title: text-lg font-semibold text-gray-900 dark:text-white (use heading-3 token if defined)
    - Card.Description: text-sm text-gray-500 dark:text-gray-400 mt-1
    - Card.Content: text-gray-700 dark:text-gray-300
    - Card.Footer: mt-6 flex justify-end gap-2 (for action buttons)

    Export Card as default, export compound components as named exports or as properties on Card object:
    ```ts
    Card.Header = CardHeader;
    Card.Title = CardTitle;
    // etc.
    ```

    Use cn() for class merging. Use TypeScript with proper prop types.
  </action>
  <verify>Card.tsx exists, compiles without errors, Card.Header/Title/Description/Content/Footer all accessible, can import from @/components/ui/Card</verify>
  <done>Card component created with compound structure (Header, Title, Description, Content, Footer), variants (default, interactive, flat), hover elevation animation for interactive cards, consistent design tokens applied</done>
</task>

<task type="auto">
  <name>Task 3: Write unit tests for Button and Card components</name>
  <files>src/components/ui/Button.test.tsx, src/components/ui/Card.test.tsx</files>
  <action>
    Create src/components/ui/Button.test.tsx using Vitest + Testing Library:
    - Test all variants render with correct classes (primary, secondary, ghost, danger)
    - Test all sizes render with correct min-height (sm=32px, md=44px, lg=56px)
    - Test disabled state prevents clicks and shows disabled styles
    - Test loading state shows spinner and prevents clicks
    - Test icon prop renders icon before text
    - Test iconOnly requires aria-label (accessibility)
    - Test onClick handler fires when clicked (unless disabled/loading)
    - Test className prop merges additional classes
    - Use render from @/lib/test-utils (for i18n provider wrapper)
    - Use screen.getByRole('button') for queries

    Create src/components/ui/Card.test.tsx:
    - Test Card renders with default variant (has shadow-card class)
    - Test interactive variant has cursor-pointer class
    - Test flat variant has no shadow
    - Test onClick handler fires for interactive cards
    - Test compound components render correctly (Card.Header, Card.Title, etc.)
    - Test Card.Title renders children text
    - Test Card.Content renders children
    - Test Card.Footer renders action buttons
    - Use render from @/lib/test-utils

    Both test files should use describe/it pattern, clear test names, and TypeScript.

    Run tests after creating: `npm test Button.test.tsx Card.test.tsx`
  </action>
  <verify>npm test shows all Button and Card tests passing, no TypeScript errors, test files compile</verify>
  <done>Button and Card components have comprehensive unit tests covering all variants, sizes, states, accessibility, and functionality. All tests pass.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm test` passes all Button and Card tests
- [ ] `npm run lint` passes
- [ ] Button component has all 4 variants and 3 sizes working
- [ ] Card component has compound structure accessible
- [ ] No TypeScript errors in components/ui/
</verification>

<success_criteria>

- All tasks completed
- Button component created with full variant/size/state support
- Card component created with compound components pattern
- Both components have smooth Framer Motion animations
- Test coverage for Button and Card (all tests passing)
- Components ready for platform-wide migration
- No build or type errors
</success_criteria>

<output>
After completion, create `.planning/phases/21-ui-design-system-enforcement/21-02-SUMMARY.md`:

# Phase 21 Plan 2: Animated UI Components Summary

**[One-liner about what shipped]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- `src/components/ui/Button.tsx` - Unified button component
- `src/components/ui/Card.tsx` - Unified card component
- `src/components/ui/Button.test.tsx` - Button tests
- `src/components/ui/Card.test.tsx` - Card tests

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 21-03-PLAN.md (Design Token Enforcement)
</output>
