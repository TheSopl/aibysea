---
phase: 21-ui-design-system-enforcement
plan: 04
type: execute
---

<objective>
Complete platform-wide component migration and add animation polish to achieve the "wow factor" without overwhelming users.

Purpose: Replace all inline button and card definitions with unified components, add page transitions and scroll-based animations, implement dashboard card stagger and animated metrics. Deliver a modern, polished UI with smooth motion design.
Output: Zero inline buttons/cards remaining, smooth page transitions, scroll animations on key sections, animated dashboard. Visual verification in light/dark mode and mobile/desktop.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-ui-design-system-enforcement/CONTEXT.md
@.planning/phases/21-ui-design-system-enforcement/21-01-SUMMARY.md
@.planning/phases/21-ui-design-system-enforcement/21-02-SUMMARY.md
@.planning/phases/21-ui-design-system-enforcement/21-03-SUMMARY.md
@.planning/codebase/STRUCTURE.md
@src/components/ui/Button.tsx
@src/components/ui/Card.tsx
@src/components/ui/PageTransition.tsx
@src/components/ui/FadeIn.tsx
@src/lib/animations/variants.ts

**Components available:**
- Button: variants (primary, secondary, ghost, danger), sizes (sm, md, lg), animations built-in
- Card: compound components (Header, Title, Description, Content, Footer), hover animations
- PageTransition: route change animations
- FadeIn: scroll-based reveals
- Animation variants: fadeIn, slideIn, scaleUp, stagger

**User requirement:** "Crazy fancy but not overwhelming — the perfect middle ground"

**From CONCERNS.md:**
- 15+ different inline button styles need replacing
- Dashboard cards, conversation cards, agent cards all use different styles
- Need to add motion design for modern feel

**Files to migrate (25+ pages):**
- All pages in src/app/[locale]/(main)/ (dashboard, inbox, agents, voice, documents, settings)
- Components: AgentFormModal, DeleteConfirmModal, dashboard widgets
- Layout: Sidebar, TopBar, BottomNav
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace all inline buttons with Button component</name>
  <files>src/app/[locale]/(main)/**/*.tsx, src/components/**/*.tsx</files>
  <action>
    Systematically replace inline button definitions with unified Button component:

    **Import at top of files:**
    ```tsx
    import Button from '@/components/ui/Button'
    ```

    **Replacement patterns:**
    - Primary actions: `<button className="bg-blue-500 hover:bg-blue-600 ...">` → `<Button variant="primary">`
    - Secondary actions: `<button className="bg-gray-200 ...">` → `<Button variant="secondary">`
    - Tertiary actions: `<button className="text-blue-500 hover:bg-blue-50 ...">` → `<Button variant="ghost">`
    - Delete/destructive: `<button className="bg-red-500 ...">` → `<Button variant="danger">`

    **Size mapping:**
    - Small buttons: size="sm"
    - Default: size="md" (44px, mobile touch target)
    - Large: size="lg"

    **Icon buttons:**
    - With text: `<Button icon={<PlusIcon />}>Add Item</Button>`
    - Icon only: `<Button iconOnly icon={<TrashIcon />} aria-label="Delete">`

    **Preserve functionality:**
    - onClick handlers: pass through as props
    - disabled state: use disabled prop
    - Loading state: use loading prop
    - className: additional classes via className prop (merged with cn())

    **Priority files:**
    1. src/app/[locale]/(main)/agents/page.tsx (Add Agent button)
    2. src/components/agents/AgentFormModal.tsx (Save, Cancel buttons)
    3. src/components/agents/DeleteConfirmModal.tsx (Delete, Cancel buttons)
    4. src/app/[locale]/(main)/dashboard/page.tsx
    5. src/app/[locale]/(main)/inbox/page.tsx (send message button)
    6. All other page files
    7. src/components/layout/Sidebar.tsx, TopBar.tsx, BottomNav.tsx

    Use grep to find button elements: `grep -r "<button" src/ --include="*.tsx"`

    After replacement, verify all buttons still work (clicks, disabled states, loading).
  </action>
  <verify>grep -r "<button" src/ --include="*.tsx" shows minimal raw button usage (only for special cases), all standard buttons use Button component, functionality preserved</verify>
  <done>All inline button definitions replaced with Button component, variants and sizes applied correctly, touch targets meet accessibility (44px min), all button interactions working</done>
</task>

<task type="auto">
  <name>Task 2: Replace all inline cards with Card component</name>
  <files>src/app/[locale]/(main)/**/*.tsx, src/components/**/*.tsx</files>
  <action>
    Replace inline card patterns with unified Card component:

    **Import at top of files:**
    ```tsx
    import Card from '@/components/ui/Card'
    ```

    **Replacement pattern:**
    Before:
    ```tsx
    <div className="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6">
      <h3 className="text-xl font-semibold">Title</h3>
      <p className="text-gray-500">Description</p>
      <div>Content...</div>
      <div className="mt-4 flex justify-end">
        <button>Action</button>
      </div>
    </div>
    ```

    After:
    ```tsx
    <Card variant="default">
      <Card.Header>
        <Card.Title>Title</Card.Title>
        <Card.Description>Description</Card.Description>
      </Card.Header>
      <Card.Content>
        Content...
      </Card.Content>
      <Card.Footer>
        <Button>Action</Button>
      </Card.Footer>
    </Card>
    ```

    **Variant selection:**
    - Default cards: variant="default" (has shadow)
    - Clickable cards: variant="interactive" + onClick handler (hover animation)
    - Nested cards: variant="flat" (no shadow)

    **Priority files:**
    1. src/app/[locale]/(main)/dashboard/page.tsx (dashboard metric cards, service cards)
    2. src/components/dashboard/* (AIMetricsDashboard, MetricsCard, etc.)
    3. src/app/[locale]/(main)/agents/page.tsx (agent cards)
    4. src/app/[locale]/(main)/voice-agents/page.tsx (voice agent cards)
    5. src/app/[locale]/(main)/documents/page.tsx (template cards)
    6. src/app/[locale]/(main)/inbox/page.tsx (conversation cards)

    Use grep to find card-like divs: `grep -r "bg-white.*rounded.*shadow" src/ --include="*.tsx"`

    Preserve hover states for interactive cards (use variant="interactive").
  </action>
  <verify>All major card patterns replaced with Card component, compound structure used (Header, Title, Content, Footer), hover animations working on interactive cards</verify>
  <done>Dashboard cards, agent cards, conversation cards all use Card component, consistent styling (shadow-card, rounded-design-lg), hover animations on clickable cards, visual consistency achieved</done>
</task>

<task type="auto">
  <name>Task 3: Add page transitions, dashboard animations, and scroll effects</name>
  <files>src/app/[locale]/(main)/layout.tsx, src/app/[locale]/(main)/dashboard/page.tsx, src/components/ui/AnimatedCounter.tsx</files>
  <action>
    Add animation polish throughout the platform:

    **1. Page transitions:**
    Wrap main content in PageTransition component:
    - Edit src/app/[locale]/(main)/layout.tsx
    - Import PageTransition from @/components/ui/PageTransition
    - Wrap {children} with `<PageTransition>{children}</PageTransition>`
    - This adds fade + slide animation on route changes

    **2. Dashboard card stagger animation:**
    Update src/app/[locale]/(main)/dashboard/page.tsx:
    - Import stagger variants from @/lib/animations/variants
    - Wrap dashboard cards grid in motion.div with stagger container variant
    - Apply stagger item variant to each card
    - Cards will animate in one-by-one on page load (50-100ms delay between each)
    - Example:
      ```tsx
      <motion.div variants={staggerContainer} initial="hidden" animate="visible">
        {cards.map((card, i) => (
          <motion.div key={i} variants={staggerItem}>
            <Card>...</Card>
          </motion.div>
        ))}
      </motion.div>
      ```

    **3. Animated counter for metrics:**
    Create src/components/ui/AnimatedCounter.tsx:
    - 'use client' component
    - Props: value (number), duration (milliseconds, default 1000)
    - Uses framer-motion's useSpring and useTransform for smooth counting animation
    - Counts from 0 to value over duration
    - Used in dashboard metric cards for visual polish
    - Example: `<AnimatedCounter value={1234} />`

    Update dashboard metric displays to use AnimatedCounter for key numbers.

    **4. Scroll-based fade-ins:**
    Add FadeIn component to key sections:
    - Dashboard: Wrap each section (metrics grid, charts) in FadeIn
    - Agents page: Wrap agent grid in FadeIn
    - Other pages: Apply to major content sections
    - Use delay prop to stagger multiple sections (delay={0.1}, delay={0.2})

    **Verify animations:**
    - Page transitions smooth (no jank)
    - Dashboard cards stagger elegantly
    - Counter animations count up smoothly
    - Scroll reveals trigger at right viewport position
    - All animations respect prefers-reduced-motion
    - Timing feels snappy (150-300ms, not sluggish)
  </action>
  <verify>Page transitions work on navigation, dashboard cards stagger on load, metrics count up smoothly, scroll-based FadeIn triggers correctly, prefers-reduced-motion respected</verify>
  <done>Full animation system implemented: PageTransition on routes, dashboard card stagger, AnimatedCounter for metrics, FadeIn on scroll for key sections, "wow factor" achieved without overwhelming, animations respect accessibility</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete UI design system enforcement with unified components and smooth animations across the platform</what-built>
  <how-to-verify>
    **Visual QA checklist:**

    1. **Run dev server:** `npm run dev`

    2. **Component verification:**
       - Visit /dashboard: All buttons use Button component, cards use Card component
       - Visit /agents: Add Agent button (primary), agent cards (Card component)
       - Visit /inbox: Send message button, conversation cards
       - Visit /voice-agents: Cards and buttons consistent
       - Visit /documents: Template cards and action buttons

    3. **Animation verification:**
       - Navigate between pages: Smooth fade + slide transition (no jank)
       - Dashboard: Cards stagger in on page load (elegant, not too slow)
       - Dashboard metrics: Numbers count up smoothly
       - Scroll down: Sections fade in as they enter viewport
       - Button hover: Subtle scale + shadow lift
       - Card hover (interactive cards): Elevation change

    4. **Design token consistency:**
       - Spacing: No jarring inconsistencies in padding/margins
       - Typography: Heading hierarchy is clear (no random sizes)
       - Colors: Service colors correct (Voice pages=teal, Docs pages=orange)
       - Shadows: Cards have consistent shadows

    5. **Accessibility:**
       - Touch targets: All buttons minimum 44px height on mobile
       - Reduced motion: Set system preference to reduce motion, reload page
         - Animations should be disabled or minimal
         - Test on macOS: System Preferences → Accessibility → Display → Reduce motion
         - Or browser DevTools: Rendering → Emulate CSS media → prefers-reduced-motion: reduce

    6. **Responsive testing:**
       - Mobile (375px): Bottom nav working, buttons/cards sized appropriately
       - Tablet (768px): Layout transitions smoothly
       - Desktop (1024px+): Full experience with animations

    7. **Dark mode:**
       - Toggle dark mode (if toggle exists)
       - All components readable (no broken colors)
       - Animations work in both modes

    8. **Performance:**
       - Animations feel snappy (not sluggish)
       - Page load time reasonable (animations don't block rendering)
       - No visible layout shift
  </how-to-verify>
  <resume-signal>Type "approved" if everything looks good, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before checkpoint:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] All inline buttons replaced with Button component
- [ ] All inline cards replaced with Card component
- [ ] Page transitions implemented
- [ ] Dashboard animations working
- [ ] Scroll-based FadeIn components added
- [ ] prefers-reduced-motion respected throughout
</verification>

<success_criteria>

- All tasks completed
- Zero inline button definitions remain (all use Button component)
- Zero inline card patterns remain (all use Card component)
- Page transitions smooth and elegant
- Dashboard card stagger animation delightful
- AnimatedCounter implemented for metrics
- Scroll-based reveals working on key sections
- Visual QA passed in light/dark mode, mobile/desktop
- Accessibility verified (44px touch targets, reduced motion support)
- "Wow factor" achieved without overwhelming
- Phase 21 complete
</success_criteria>

<output>
After completion, create `.planning/phases/21-ui-design-system-enforcement/21-04-SUMMARY.md`:

# Phase 21 Plan 4: Component Migration & Animation Polish Summary

**[One-liner about what shipped]**

## Accomplishments

- [Key outcomes]
- [Button replacements count]
- [Card replacements count]
- [Animation features added]

## Files Created/Modified

- [List of pages and components updated]
- `src/components/ui/AnimatedCounter.tsx` - Smooth number counting animation

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 21 complete. Ready for Phase 22 (Arabic & RTL Excellence)
</output>
