---
phase: 08-realtime-hud-annotations
plan: 01
type: auto
domain: conversation-interface
---

<objective>
Build the Contacts and Conversations views with real-time HUD annotations showing AI reasoning, confidence, and decision transparency.

Purpose: Add visual intelligence feedback on every message. Annotations show: context loaded, confidence score, response time, KB sources, AI reasoning. Smart filters (risk, sentiment, VIP, churn risk) help users navigate conversations intelligently.
Output: Fully functional Contacts page with smart filters, Contact detail page with conversation view, HUD annotations on every AI message, and design-system styled interface.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
.planning/DESIGN-SYSTEM-V1.1.md
.planning/FEATURE-MOCKUP-V1.1.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/DESIGN-SYSTEM-V1.1.md
@.planning/FEATURE-MOCKUP-V1.1.md

**Design System (from DESIGN-SYSTEM-V1.1.md):**
- Contacts: Dark cards with risk badges (red/amber/green), VIP indicators (üíé)
- Messages: Customer bubbles (dark-surface), AI bubbles (teal-accented with Rashed avatar)
- Annotations: Small monospace text, secondary text color, expandable sections
- Colors: Teal for AI/primary, Red for risk/urgent, Green for positive, Pink for warnings

**Features to implement (from FEATURE-MOCKUP-V1.1.md):**
- Smart Filters: Risk level, sentiment, VIP, churn risk, best experience, new, trending
- Contact Cards: Name, platform, sentiment badge, risk score, value indicator, wait time, likely next action
- Conversation View: Message stream, AI reasoning sidebar (expandable), quality metrics per message
- HUD Annotations: [üìä Context Loaded: 12 msgs], [üß† Confidence: 87%], [‚è±Ô∏è TTFT: 180ms], [üîÑ TPOT: 45ms], [KB: Returns Policy]

**Tech available:**
- All components from Phase 7 (dashboard, design tokens, Zustand store)
- Supabase for contact/conversation queries
- Rashed avatar already integrated
- Design system fully implemented

**Key interactions:**
- Click contact ‚Üí open conversation
- Expand reasoning ‚Üí smooth reveal animation
- Filter by sentiment ‚Üí real-time list update
- Hover annotation ‚Üí show details
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Contacts page with smart filters and contact cards</name>
  <files>src/app/dashboard/contacts/page.tsx, src/components/contacts/ContactList.tsx, src/components/contacts/ContactCard.tsx, src/components/contacts/SmartFilters.tsx</files>
  <action>Build responsive Contacts page showing contact list with smart filter pills at top: [All], [‚ö†Ô∏è Risk], [üò† Mood], [üíé VIP], [üî¥ Churn], [‚≠ê Best], [üÜï New], [üîî Trending]. Each contact card shows: üë§ Name (platform), sentiment badge (üü¢ Positive, üî¥ Angry, üü° Neutral), risk score color-coded (green/amber/red), value indicator, last message time, message count, resolved time, likely next action prediction. Cards are clickable to open conversation. Use design system colors and hover effects (scale 1.02, glow). Make responsive grid layout.</action>
  <verify>npm run dev, visit /dashboard/contacts, see contact list with all cards visible. Click filter pills, list updates. Hover cards show glow effect. Click contact card ‚Üí navigate to conversation.</verify>
  <done>Contact list page built with smart filters working, cards styled per design system, filtering functional, navigation to conversations working</done>
</task>

<task type="auto">
  <name>Task 2: Create Conversation page with message stream and message bubbles</name>
  <files>src/app/dashboard/contacts/[id]/page.tsx, src/components/conversations/ConversationView.tsx, src/components/conversations/MessageBubble.tsx</files>
  <action>Build conversation page showing message stream. Customer messages: dark-surface background, left-aligned, light text. AI messages: teal-accented border on left, Rashed avatar (48px) on left, name "Rashed" above message, smooth scroll to latest message on load. Header shows contact name, sentiment, risk, value. Implement smooth message animations: fade-in + slide-up (300ms) for incoming messages. Make responsive layout (full-width on mobile, sidebar on desktop).</action>
  <verify>npm run dev, visit conversation, see messages streaming in with animations. Customer messages on left (dark), AI messages with teal accent + avatar. Scroll position stays at bottom on new messages. Mobile layout responsive (full-width). No TypeScript errors.</verify>
  <done>Conversation view renders with animated message bubbles, proper styling per design system, responsive layout, smooth animations</done>
</task>

<task type="auto">
  <name>Task 3: Create HUD annotations (expandable reasoning, metadata, quality scores)</name>
  <files>src/components/conversations/AIReasoning.tsx, src/components/conversations/MessageAnnotations.tsx</files>
  <action>Build expandable reasoning component showing AI decision logic per message. Collapsed shows single line: "[üß† AI REASONING ‚ñº]". Expanded shows: ‚îú‚îÄ Detected: ..., ‚îú‚îÄ Context: ..., ‚îú‚îÄ Policy: ..., ‚îú‚îÄ Strategy: ..., ‚îú‚îÄ Confidence: %, ‚îî‚îÄ Next: ... . Use monospace font (JetBrains Mono) for technical feel. Add message quality annotations below each AI message: [‚úÖ Quality: 96%], [‚è±Ô∏è Speed: 245ms], [üìä Helpful: Yes]. Expandable reveal animation (max-height 0‚Üíauto, opacity 0‚Üí1, 300ms). All metadata uses secondary text color.</action>
  <verify>npm run dev, see collapsed reasoning "[üß† AI REASONING ‚ñº]" under each AI message. Click to expand, smooth reveal animation. Quality scores display below messages with checkmarks. Monospace font for technical metadata. Mobile responsive (annotations don't overflow).</verify>
  <done>HUD annotations implemented with expandable reasoning, quality scores, smooth animations, monospace typography for technical data</done>
</task>

<task type="auto">
  <name>Task 4: Add conversation intelligence sidebar (sentiment, risk, category, upsell)</name>
  <files>src/components/conversations/ConversationIntel.tsx</files>
  <action>Build right sidebar showing conversation intelligence: Category (Returns, General, etc), Sentiment progression (was Frustrated ‚Üí now Resolved), Risk score (üü¢ LOW), Customer value (Regular/High/VIP), Knowledge used (KB pulls like "Returns Policy"), Learned from (X previous similar), Upsell opportunities (Y% match), Recommended next action. Use cards with design system colors. Make collapsible on mobile (hamburger icon reveals sidebar).</action>
  <verify>npm run dev, see sidebar on desktop with conversation metadata. Mobile: hamburger icon shows/hides sidebar. All data displays correctly with proper color coding (green for positive, red for risk). Responsive layout works.</verify>
  <done>Conversation intelligence sidebar shows all metadata, proper color hierarchy, responsive collapse on mobile, design system styled</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Contacts page loads with contact list
- [ ] Smart filters functional (click filters, list updates)
- [ ] Contact cards styled with design system colors
- [ ] Navigation from contact ‚Üí conversation works
- [ ] Conversation page renders message stream
- [ ] Message bubbles styled correctly (customer dark, AI teal)
- [ ] Rashed avatar displays with teal border
- [ ] Message animations smooth (fade-in + slide)
- [ ] HUD annotations visible and expandable
- [ ] Quality scores display per AI message
- [ ] Conversation intelligence sidebar shows metadata
- [ ] Mobile responsive layout works
- [ ] No TypeScript errors
</verification>

<success_criteria>

- Contacts page fully functional with smart filters
- All contact cards styled per design system
- Conversation page with animated message stream
- HUD annotations showing AI reasoning, expandable with smooth animation
- Quality scores (Quality %, Speed ms, Helpful Y/N) visible per message
- Sentiment badges and risk indicators color-coded correctly
- Rashed avatar integrated into AI message bubbles
- Conversation intelligence sidebar with all metadata
- Mobile responsive: sidebar collapses to hamburger
- All animations smooth (200-300ms), no jank
- TypeScript strict mode passes

</success_criteria>

<output>
After completion, create `.planning/phases/08-realtime-hud-annotations/08-01-SUMMARY.md`:

# Phase 8 Plan 01: Real-time HUD & Annotations Summary

**Built Contacts and Conversations pages with smart filtering and AI decision transparency.**

## Accomplishments

- Created Contacts page with smart filter pills (Risk, Mood, VIP, Churn, etc)
- Built contact cards with sentiment badges, risk indicators, value scoring
- Implemented Conversations page with animated message stream
- Added Rashed avatar to AI message bubbles with teal accent styling
- Built expandable HUD annotations showing AI reasoning (Detected, Context, Policy, Confidence, Next)
- Implemented quality scores per message (Quality %, Speed ms, Helpful)
- Created conversation intelligence sidebar (Category, Sentiment, Risk, Value, KB, Upsell)
- All components styled per design system (dark backgrounds, teal accents, proper color hierarchy)
- Smooth animations: message arrivals (300ms fade-in + slide), reasoning expand (300ms)
- Responsive design: sidebar collapses on mobile, full-width conversations

## Files Created/Modified

- `src/app/dashboard/contacts/page.tsx` - Contacts list page
- `src/components/contacts/ContactList.tsx` - Contact list component
- `src/components/contacts/ContactCard.tsx` - Individual contact card
- `src/components/contacts/SmartFilters.tsx` - Filter pills component
- `src/app/dashboard/contacts/[id]/page.tsx` - Conversation detail page
- `src/components/conversations/ConversationView.tsx` - Message stream
- `src/components/conversations/MessageBubble.tsx` - Message bubble styling
- `src/components/conversations/AIReasoning.tsx` - Expandable reasoning
- `src/components/conversations/MessageAnnotations.tsx` - Quality/metadata annotations
- `src/components/conversations/ConversationIntel.tsx` - Intelligence sidebar

## Design Decisions Made

- HUD annotations expandable (not always visible) to reduce cognitive load
- Monospace font for technical metadata (JetBrains Mono) for professional feel
- Sentiment/risk color-coding: green (positive), amber (caution), red (urgent)
- Rashed avatar in message bubbles distinguishes AI from UI
- Sidebar collapses on mobile to maximize conversation space
- Message animations (300ms) smooth but not slow
- Quality scores below each message prove AI is working well

## Next Steps

Phase 9: Autonomy Showcase - End-to-end Telegram conversation handling visible

</output>
