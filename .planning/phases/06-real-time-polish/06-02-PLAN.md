---
phase: 06-real-time-polish
plan: 02
type: execute
domain: next-js
---

<objective>
Implement Arabic RTL (right-to-left) support so the UI adapts correctly for Arabic-speaking users and satisfies the "Arabic-first before company rollout" requirement.

Purpose: Prepare the application for internal company rollout with proper RTL layout, text direction, and semantic HTML for bilingual support.

Output: RTL-aware layout system, CSS adaptations, semantic HTML structure, language context support (English by default, Arabic-ready).
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-human-takeover/05-01-SUMMARY.md

# Key files affected by this phase
@src/app/layout.tsx
@src/app/globals.css
@src/app/dashboard/layout.tsx
@src/components/ChatList.tsx
@src/components/MessageBubble.tsx
@src/components/TakeoverButton.tsx

# Tech stack available (from prior phases)
- Next.js 16 with Tailwind CSS
- React components (server and client)
- Supabase for data layer
- Tailwind CSS utilities for responsive design

# Established patterns
- Tailwind CSS for styling
- Component-based architecture
- Server components for layouts

# Current state
- All UI currently assumes LTR (left-to-right)
- HTML lang="en" hard-coded in layout.tsx
- No RTL CSS classes or media queries
- Flexbox and margin patterns assume LTR direction

# Implementation approach
RTL support requires:
1. dir="rtl" attribute on html element based on language context
2. CSS logical properties (use margin-inline, padding-inline, etc.) where direction matters
3. Tailwind CSS RTL plugin or manual dir: pseudo-class selectors
4. Semantic HTML adjustments (e.g., icon positioning based on direction)
5. Language context provider (optional for MVP, can default to English)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add RTL support to root layout and globals</name>
  <files>src/app/layout.tsx, src/app/globals.css</files>
  <action>
    Set up RTL infrastructure at the application root:

    1. Update src/app/layout.tsx:
       - Change `<html lang="en">` to support dynamic language
       - For MVP, keep default lang="en" but use dir={isArabic ? 'rtl' : 'ltr'}
       - For MVP simplicity, default to "en" and dir="ltr" (can be made dynamic later)
       - Add `<html lang="en" dir="ltr">` to the root element

    2. Update src/app/globals.css:
       - Add CSS logical properties for text-sensitive spacing
       - Add :dir(rtl) pseudo-class rules for RTL-specific overrides
       - Keep existing LTR styling as default
       - Add rules for common patterns: margins, padding, text alignment, flex direction

    Implementation strategy:
    - Use CSS logical properties (margin-inline-start, padding-inline-end, etc.) in globals.css
    - Use :dir(rtl) pseudo-class selector for direction-specific rules
    - Tailwind CSS should automatically handle logical properties in RTL mode
    - Common RTL adjustments: sidebar flex direction, message alignment, icon positioning

    Key components to prepare for RTL:
    - Dashboard layout (sidebar left/right based on direction)
    - Message list (scroll direction, message alignment)
    - Chat list (icon/text positioning)
    - Form inputs (text-align, padding direction)
    - Icons and badges (may need horizontal flip or repositioning)
  </action>
  <verify>
    1. npm run build succeeds
    2. HTML renders with dir="ltr" (visible in DevTools inspector)
    3. Open DevTools inspector, toggle `dir="rtl"` manually on html element
    4. Layout should adapt (sidebar, text alignment) based on dir attribute
    5. No console errors about unknown CSS properties
  </verify>
  <done>
    - layout.tsx has dir attribute set to "ltr" (foundation for future dynamic language)
    - globals.css includes CSS logical properties and :dir(rtl) rules
    - LTR remains default, RTL rules ready for component-level styling
    - Build succeeds without warnings
  </done>
</task>

<task type="auto">
  <name>Task 2: Apply RTL styles to dashboard and message components</name>
  <files>src/app/dashboard/layout.tsx, src/components/ChatList.tsx, src/components/MessageBubble.tsx, src/components/MessageCompose.tsx</files>
  <action>
    Adapt key components to be RTL-ready:

    1. src/app/dashboard/layout.tsx:
       - Review flex layout structure (currently sidebar left, content right)
       - For LTR: keep as-is (sidebar left, content right)
       - Add RTL variant: use flex-row-reverse within :dir(rtl) or use CSS grid with direction awareness
       - Ensure no hard-coded margin-left/margin-right - use logical properties
       - Add comment marking this as RTL-aware

    2. src/components/ChatList.tsx:
       - Review list item structure and icon placement
       - Icons should be positioned correctly in RTL (no icon flip needed for simple icons)
       - Ensure text-align doesn't assume LTR
       - Use margin-inline instead of margin-left/right for spacing

    3. src/components/MessageBubble.tsx:
       - Message alignment: AI messages align one way, human messages another
       - In RTL: AI and human positions should swap
       - Use Tailwind's `rtl:` prefix or :dir(rtl) rule to swap text-align and margins
       - Example: LTR has text-left for AI, text-right for human â†’ RTL inverts these
       - Icon/emoji positioning within bubble should be RTL-aware

    4. src/components/MessageCompose.tsx:
       - Input field layout (button left/right of input)
       - Use flex-row-reverse or grid with direction awareness
       - Icon positioning within input field
       - Ensure padding is direction-aware (padding-inline)

    Implementation notes:
    - Use Tailwind's `rtl:` variant (e.g., `flex-row rtl:flex-row-reverse`)
    - Or use :dir(rtl) { } in component's inline styles or global CSS
    - Test each component by toggling dir="rtl" in DevTools inspector
    - Focus on user-visible elements (layout, alignment, spacing)
  </action>
  <verify>
    1. npm run dev
    2. Navigate to dashboard with conversation
    3. In DevTools inspector, change html dir from "ltr" to "rtl"
    4. Verify layout adapts:
       - Sidebar repositions (right side in RTL)
       - Message text alignment reverses
       - Input/button layout inverts
       - Chat list layout adapts
    5. No visual glitches or overlapping elements
    6. Change back to dir="ltr" - layout returns to normal
    7. Build completes without errors
  </verify>
  <done>
    - Dashboard layout is RTL-aware (sidebar and content flex direction adapts)
    - Message bubbles align correctly in RTL (AI/human positions swap)
    - Message compose layout is RTL-ready (button and input positioning)
    - Chat list is RTL-friendly (no hard-coded LTR margins)
    - All changes use CSS logical properties or :dir(rtl) rules
    - No component-specific RTL hacks (all styling in globals.css and components)
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Arabic RTL support foundation with proper layout adaptation, component styling for RTL mode, and language attribute structure.
    - Root layout has dir attribute support
    - CSS uses logical properties (margin-inline, padding-inline, etc.)
    - Components styled for both LTR and RTL directions
    - DevTools-testable: toggle dir="rtl" to see instant layout changes
  </what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Open http://localhost:3000/dashboard
    3. Open DevTools -> Inspector
    4. Find the <html> element
    5. Edit the html element to change dir="ltr" to dir="rtl" manually
    6. Test LTR layout (current state):
       a. Chat list on left side
       b. Conversation on right side
       c. Messages from AI left-aligned, human messages right-aligned
       d. Input field with button to the right
    7. Test RTL layout (after toggling dir):
       a. Chat list should move to right side (if using flex-row-reverse)
       b. Conversation should move to left side
       c. Message alignment should reverse (AI messages right, human left)
       d. Input button should move to left side
       e. All text still readable (no weird overlaps)
    8. Toggle back to dir="ltr" and verify layout returns to normal
    9. Verify no console errors or warnings
    10. Test on mobile view (tablet/phone) - layout still correct in RTL
  </how-to-verify>
  <resume-signal>
    Type "approved" if RTL layout changes work correctly, or describe any layout issues to fix
  </resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run dev` starts without errors
- [ ] HTML has dir="ltr" attribute in root element
- [ ] Toggle dir="rtl" in DevTools inspector
- [ ] Dashboard layout adapts (sidebar repositions)
- [ ] Message bubbles align correctly in RTL mode
- [ ] Input/compose field layout inverts in RTL
- [ ] Toggle back to dir="ltr" - all returns to normal
- [ ] No console errors or warnings
- [ ] Mobile responsive layout works in both LTR and RTL
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- RTL foundation in place (dir attribute, CSS logical properties)
- Components adapt to RTL without code duplication
- Layout visually correct in both LTR and RTL modes
- No TypeScript errors
- Ready for future language context provider or language switcher UI

</success_criteria>

<output>
After completion, create `.planning/phases/06-real-time-polish/06-02-SUMMARY.md`:

# Phase 6 Plan 02: Arabic RTL Support Summary

**[One-liner: e.g., "Implemented RTL layout infrastructure and component styling for Arabic language support - UI adapts correctly based on text direction"]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `src/app/layout.tsx` - Added dir attribute to html element
- `src/app/globals.css` - Added CSS logical properties and :dir(rtl) rules
- `src/app/dashboard/layout.tsx` - RTL-aware flex layout
- `src/components/ChatList.tsx` - Direction-aware spacing
- `src/components/MessageBubble.tsx` - RTL message alignment
- `src/components/MessageCompose.tsx` - RTL-ready input layout

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Phase 6 complete - application ready for internal rollout with real-time updates and Arabic RTL support
</output>
