---
phase: 01-foundation
plan: 01
type: execute
---

<objective>
Set up Next.js project with Supabase client configuration.

Purpose: Establish the foundational project structure that all subsequent phases build upon.
Output: Working Next.js 14 app with Supabase client utilities ready for database and auth integration.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Tech decisions from PROJECT.md:**
- Next.js + Supabase stack
- Vercel + Supabase Cloud hosting
- TypeScript required
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Next.js project with TypeScript and Tailwind</name>
  <files>package.json, tsconfig.json, tailwind.config.ts, src/app/layout.tsx, src/app/page.tsx</files>
  <action>
    Run `npx create-next-app@latest . --typescript --tailwind --eslint --app --src-dir --import-alias "@/*"` to scaffold project in current directory.

    Accept defaults for all prompts. This creates:
    - Next.js 14+ with App Router
    - TypeScript configuration
    - Tailwind CSS with PostCSS
    - ESLint configuration
    - src/ directory structure
    - Path alias @/* for imports

    After creation, verify the dev server starts with `npm run dev`.
  </action>
  <verify>npm run dev starts without errors, http://localhost:3000 shows Next.js welcome page</verify>
  <done>Next.js project created with TypeScript, Tailwind, App Router, src/ directory structure</done>
</task>

<task type="auto">
  <name>Task 2: Configure Supabase client utilities</name>
  <files>src/lib/supabase/client.ts, src/lib/supabase/server.ts, src/lib/supabase/middleware.ts, .env.local.example</files>
  <action>
    1. Install Supabase packages:
       `npm install @supabase/supabase-js @supabase/ssr`

    2. Create src/lib/supabase/client.ts - Browser client for client components:
       ```typescript
       import { createBrowserClient } from '@supabase/ssr'

       export function createClient() {
         return createBrowserClient(
           process.env.NEXT_PUBLIC_SUPABASE_URL!,
           process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
         )
       }
       ```

    3. Create src/lib/supabase/server.ts - Server client for Server Components and Route Handlers:
       ```typescript
       import { createServerClient } from '@supabase/ssr'
       import { cookies } from 'next/headers'

       export async function createClient() {
         const cookieStore = await cookies()

         return createServerClient(
           process.env.NEXT_PUBLIC_SUPABASE_URL!,
           process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
           {
             cookies: {
               getAll() {
                 return cookieStore.getAll()
               },
               setAll(cookiesToSet) {
                 try {
                   cookiesToSet.forEach(({ name, value, options }) =>
                     cookieStore.set(name, value, options)
                   )
                 } catch {
                   // Called from Server Component - ignore
                 }
               },
             },
           }
         )
       }
       ```

    4. Create src/lib/supabase/middleware.ts - For auth session refresh in middleware:
       ```typescript
       import { createServerClient } from '@supabase/ssr'
       import { NextResponse, type NextRequest } from 'next/server'

       export async function updateSession(request: NextRequest) {
         let supabaseResponse = NextResponse.next({
           request,
         })

         const supabase = createServerClient(
           process.env.NEXT_PUBLIC_SUPABASE_URL!,
           process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
           {
             cookies: {
               getAll() {
                 return request.cookies.getAll()
               },
               setAll(cookiesToSet) {
                 cookiesToSet.forEach(({ name, value }) => request.cookies.set(name, value))
                 supabaseResponse = NextResponse.next({
                   request,
                 })
                 cookiesToSet.forEach(({ name, value, options }) =>
                   supabaseResponse.cookies.set(name, value, options)
                 )
               },
             },
           }
         )

         // Refresh session if expired
         await supabase.auth.getUser()

         return supabaseResponse
       }
       ```

    5. Create .env.local.example with required variables (no actual values):
       ```
       NEXT_PUBLIC_SUPABASE_URL=your-project-url
       NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
       ```

    Do NOT create actual .env.local - user will add their Supabase credentials.
  </action>
  <verify>npm run build succeeds (TypeScript compilation passes), all files exist in src/lib/supabase/</verify>
  <done>Supabase client utilities created for browser, server, and middleware contexts. .env.local.example documents required variables.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run dev` starts without errors
- [ ] `npm run build` succeeds
- [ ] src/lib/supabase/ contains client.ts, server.ts, middleware.ts
- [ ] .env.local.example exists with NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY
</verification>

<success_criteria>

- Next.js 14+ project with App Router and TypeScript
- Tailwind CSS configured
- Supabase client utilities ready for all contexts (browser, server, middleware)
- Environment variable structure documented
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
